<!DOCTYPE html>
<html class="loginHtml">

<head>
    <meta charset="utf-8">
    <title>完善个人信息--layui后台管理模板 2.0</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="/css/public.css" media="all" />
</head>

<body>
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
        <legend>信息完善</legend>
    </fieldset>
    <div class="layui-row" style="margin-bottom:44px;">
        <div class="layui-col-xs12 layui-col-md8 layui-col-lg6">
            <form class="layui-form" id="completion-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">公司LOGO：</label>
                    <div class="layui-input-block">
                        <div class="layui-upload">
                            <div class="layui-upload-list">
                                <img class="layui-upload-img" id="imgSrc" src="{$companyInfo['pic_url']}" onerror="this.src='/images/logo.png'">
                                <input type="hidden" id="id" name="id" value="{$companyInfo['id']}">
                                <input type="hidden" id="pic_url" name="pic_url" value="{$companyInfo['pic_url']}">
                                <button type="button" class="layui-btn" id="pic">上传LOGO</button>
                                <p id="uploadText"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">公司名称：</label>
                    <div class="layui-input-block">
                        <input type="text" id="name" name="name" lay-verify="required" autocomplete="off" placeholder="请输入公司名称"
                            class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">社会统一信用代码：</label>
                    <div class="layui-input-block">
                        <input type="text" id="social_code" name="social_code" lay-verify="required" autocomplete="off"
                            placeholder="请输入社会统一信用代码" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">营业执照：</label>
                    <div class="layui-input-block">
                        <div class="layui-upload">
                            <div class="layui-upload-list">
                                <img class="layui-upload-img" id="imgSrc2" src="{$companyInfo['license_pic']}" onerror="this.src='/images/logo.png'">
                                <input type="hidden" id="license_pic" name="license_pic" value="{$companyInfo['license_pic']}">
                                <button type="button" class="layui-btn" id="pic2">上传营业执照</button>
                                <p id="uploadText2"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">注册地址：</label>
                    <div class="layui-input-block">
                        <input type="text" id="reg_address" name="reg_address" lay-verify="required" autocomplete="off"
                            placeholder="请输入注册地址" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">经营地址：</label>
                    <div class="layui-input-block">
                        <input type="text" id="ope_address" name="ope_address" lay-verify="required" autocomplete="off"
                            placeholder="请输入经营地址" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">开户行名称：</label>
                    <div class="layui-input-block">
                        <input type="text" id="bank_name" name="bank_name" lay-verify="required" autocomplete="off"
                            placeholder="请输入开户行名称" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">银行账户：</label>
                    <div class="layui-input-block">
                        <input type="text" id="bank_account" name="bank_account" lay-verify="required" autocomplete="off"
                            placeholder="请输入银行账户" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">联系人：</label>
                    <div class="layui-input-block">
                        <input type="text" id="contact_name" name="contact_name" lay-verify="required" autocomplete="off"
                            placeholder="请输入联系人" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">联系电话：</label>
                    <div class="layui-input-block">
                        <input type="text" id="mobile" name="mobile" lay-verify="required" autocomplete="off"
                            placeholder="请输入联系电话" class="layui-input" value="">
                    </div>
                </div>
                <!--{$companyInfo.user_name} <div class="layui-form-item">
                    <label class="layui-form-label">注册日期：</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="reg_date" name="reg_date" lay-verify="required|regDteVerify"
                            placeholder="yyyy-MM-dd" readonly="">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">失效日期：</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="end_date" name="end_date" lay-verify="required"
                            placeholder="yyyy-MM-dd" readonly="">
                    </div>
                </div> -->
                <div class="layui-form-item">
                    <label class="layui-form-label">公司规模分类：</label>
                    <div class="layui-input-block">
                        <select id="gm_class" name="gm_class" lay-verify="required" lay-search="">
                            <option value="">直接选择或搜索选择</option>
                            <option value="1">一般纳税人</option>
                            <option value="2">小规模纳税人</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">国民经济分类：</label>
                    <div class="layui-input-block">
                        <select id="eco_class" name="eco_class" lay-verify="required" lay-search="">
                            <option value="">直接选择或搜索选择</option>
                            <option value="01">农业</option>
                            <option value="02">林业</option>
                            <option value="03">畜牧业</option>
                            <option value="04">渔业</option>
                            <option value="05">农、林、牧、渔专业及辅助性活动</option>
                            <option value="06">煤炭开采和洗选业</option>
                            <option value="07">石油和天然气开采业</option>
                            <option value="08">黑色金属矿采选业</option>
                            <option value="09">有色金属矿采选业</option>
                            <option value="10">非金属矿采选业</option>
                            <option value="11">开采专业及辅助性活动</option>
                            <option value="12">其他采矿业</option>
                            <option value="13">农副食品加工业</option>
                            <option value="14">食品制造业</option>
                            <option value="15">酒、饮料和精制茶制造业</option>
                            <option value="16">烟草制品业</option>
                            <option value="17">纺织业</option>
                            <option value="18">纺织服装、服饰业</option>
                            <option value="19">皮革、毛皮、羽毛及其制品和制鞋业</option>
                            <option value="20">木材加工和木、竹、藤、棕、草制品业</option>
                            <option value="21">家具制造业</option>
                            <option value="22">造纸和纸制品业</option>
                            <option value="23">印刷和记录媒介复制业</option>
                            <option value="24">文教、工美、体育和娱乐用品制造业</option>
                            <option value="25">石油、煤炭及其他燃料加工业</option>
                            <option value="26">化学原料和化学制品制造业</option>
                            <option value="27">医药制造业</option>
                            <option value="28">化学纤维制造业</option>
                            <option value="29">橡胶和塑料制品业</option>
                            <option value="30">非金属矿物制品业</option>
                            <option value="31">黑色金属冶炼和压延加工业</option>
                            <option value="32">有色金属冶炼和压延加工业</option>
                            <option value="33">金属制品业</option>
                            <option value="34">通用设备制造业</option>
                            <option value="35">专用设备制造业</option>
                            <option value="36">汽车制造业</option>
                            <option value="37">铁路、船舶、航空航天和其他运输设备制造业</option>
                            <option value="38">电气机械和器材制造业</option>
                            <option value="39">计算机、通信和其他电子设备制造业</option>
                            <option value="40">仪器仪表制造业</option>
                            <option value="41">其他制造业</option>
                            <option value="42">废弃资源综合利用业</option>
                            <option value="43">金属制品、机械和设备修理业</option>
                            <option value="44">电力、热力生产和供应业</option>
                            <option value="45">燃气生产和供应业</option>
                            <option value="46">水的生产和供应业</option>
                            <option value="47">房屋建筑业</option>
                            <option value="48">土木工程建筑业</option>
                            <option value="49">建筑安装业</option>
                            <option value="50">建筑装饰、装修和其他建筑业</option>
                            <option value="51">批发业</option>
                            <option value="52">零售业</option>
                            <option value="53">铁路运输业</option>
                            <option value="54">道路运输业</option>
                            <option value="55">水上运输业</option>
                            <option value="56">航空运输业</option>
                            <option value="57">管道运输业</option>
                            <option value="58">多式联运和运输代理业</option>
                            <option value="59">装卸搬运和仓储业</option>
                            <option value="60">邮政业</option>
                            <option value="61">住宿业</option>
                            <option value="62">餐饮业</option>
                            <option value="63">电信、广播电视和卫星传输服务</option>
                            <option value="64">互联网和相关服务</option>
                            <option value="65">软件和信息技术服务业</option>
                            <option value="66">货币金融服务</option>
                            <option value="67">资本市场服务</option>
                            <option value="68">保险业</option>
                            <option value="69">其他金融业</option>
                            <option value="70">房地产业</option>
                            <option value="71">租赁业</option>
                            <option value="72">商务服务业</option>
                            <option value="73">研究和试验发展</option>
                            <option value="74">专业技术服务业</option>
                            <option value="75">科技推广和应用服务业</option>
                            <option value="76">水利管理业</option>
                            <option value="77">生态保护和环境治理业</option>
                            <option value="78">公共设施管理业</option>
                            <option value="79">土地管理业</option>
                            <option value="80">居民服务业</option>
                            <option value="81">机动车、电子产品和日用产品修理业</option>
                            <option value="82">其他服务业</option>
                            <option value="83">教育</option>
                            <option value="84">卫生</option>
                            <option value="85">社会工作</option>
                            <option value="86">新闻和出版业</option>
                            <option value="87">广播、电视、电影和录音制作业</option>
                            <option value="88">文化艺术业</option>
                            <option value="89">体育</option>
                            <option value="90">娱乐业</option>
                            <option value="91">中国共产党机关</option>
                            <option value="92">国家机构</option>
                            <option value="93">人民政协、民主党派</option>
                            <option value="94">社会保障</option>
                            <option value="95">群众团体、社会团体和其他成员组织</option>
                            <option value="96">基层群众自治组织及其他组织</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item input-item">
                    <label class="layui-form-label">税务分类：</label>
                    <div class="layui-input-block">
                        <select id="tax_class" name="tax_class" lay-verify="required" lay-search="">
                            <option value="">直接选择或搜索选择</option>
                            {volist name="taxClass" id="vo" empty="没有数据"}
                            <option value="{$vo['code']}">{$vo['name']}</option>
                            {/volist}
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">邮编：</label>
                    <div class="layui-input-block">
                        <input type="text" id="post_code" name="post_code" lay-verify="required" autocomplete="off"
                            placeholder="请输入邮编" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item input-item">
                    <label class="layui-form-label">客户经理：</label>
                    <div class="layui-input-block">
                        <select id="customerinfo" name="customerinfo" lay-verify="required" lay-search="">
                            <option value="">直接选择或搜索选择</option>
                            {volist name="customerList" id="vo" empty="没有数据"}
                            <option value="{$vo['id']}-{$vo['mobile']}">{$vo['realname']} - {$vo['mobile']}</option>
                            {/volist}
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <button class="layui-btn layui-block" lay-filter="save" lay-submit>提交资料</button>
                </div>
            </form>
        </div>
    </div>
    <div style="width:100%;position: fixed;bottom: 0;height: 44px;line-height: 44px;padding: 0 15px;background-color: #eee;text-align: center;">
        <p><span><a href="http://www.beian.miit.gov.cn">苏ICP备19021827号 copyright @2019-2021</a>版权所有：蜂鸟网络科技（江阴）有限公司</span></p>
    </div>
    <script type="text/javascript" src="/layui/layui.js"></script>
    <script type="text/javascript" src="/js/cache.js"></script>
    <script>
        layui.use('upload', function () {
            var upload = layui.upload,
                imgBase64,imgBase642
            var uploadInst = upload.render({
                elem: '#pic',
                url: '{:url("uploadImg")}',
                ext: 'jpg|png|gif',
                before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    layer.msg('上传中...', { time: 999999 });
                    obj.preview(function (index, file, result) {
                        imgBase64 = result; //图片链接（base64）
                    });
                }, done: function (res) {
                    if (res.code) {
                        //上传成功
                        $('#imgSrc').attr('src', imgBase64);
                        layer.msg('上传成功', { icon: 1 });
                        $('#uploadText').text("");
                        $('#pic_url').val(res.data);
                    } else {
                        //如果上传失败
                        return layer.msg(res.msg);

                    }
                }
                , error: function () {
                    //演示失败状态，并实现重传
                    var uploadText = $('#uploadText');
                    uploadText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                    uploadText.find('.demo-reload').on('click', function () {
                        uploadInst.upload();
                    });
                }
            });
            var uploadInst2 = upload.render({
                elem: '#pic2',
                url: '{:url("uploadImg2")}',
                ext: 'jpg|png|gif',
                before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    layer.msg('上传中...', { time: 999999 });
                    obj.preview(function (index, file, result) {
                        imgBase642 = result; //图片链接（base64）
                    });
                }, done: function (res) {
                    if (res.code) {
                        //上传成功
                        $('#imgSrc2').attr('src', imgBase642);
                        layer.msg('上传成功', { icon: 1 });
                        $('#uploadText2').text("");
                        $('#license_pic').val(res.data);
                    } else {
                        //如果上传失败
                        return layer.msg(res.msg);

                    }
                }
                , error: function () {
                    //演示失败状态，并实现重传
                    var uploadText2 = $('#uploadText2');
                    uploadText2.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                    uploadText2.find('.demo-reload').on('click', function () {
                        uploadInst2.upload();
                    });
                }
            });
        });
        // layui.use('laydate', function () {
        //     var laydate = layui.laydate;

        //     laydate.render({
        //         elem: '#reg_date'
        //     });
        //     laydate.render({
        //         elem: '#end_date'
        //     });
        // });
        layui.use(['form', 'layer', 'jquery'], function () {
            var form = layui.form,
                layer = parent.layer === undefined ? layui.layer : top.layer
            $ = layui.jquery,

                $(".loginBody .seraph").click(function () {
                    layer.msg("这只是做个样式，至于功能，你见过哪个后台能这样登录的？还是老老实实的找管理员去注册吧", {
                        time: 5000
                    });
                })

            //登录按钮
            form.on("submit(save)", function (data) {
                var obj = $(this);
                var data = data.field;
                console.log(data);
                obj.text("信息保存中...").attr("disabled", "disabled").addClass("layui-disabled");
                $.ajax({
                    url: "{:url('/admin_sp/login/completion_info')}",
                    type: 'post',
                    dataType: 'json',
                    data: data,
                    success: function (data) {
                        var icon = 5;
                        if (data.code) {
                            icon = 6;
                        }
                        layer.msg(data.msg, { icon: icon }, function () {
                            if (data.code) {
                                location.href = data.url;
                            } else {
                                obj.text("提交资料").removeAttr("disabled").removeClass("layui-disabled");
                                $('#code').val('');
                            }
                        });
                    },
                    error: function (e) {
                        obj.text("提交资料").removeAttr("disabled").removeClass("layui-disabled");
                        layer.msg('出错了', { icon: 5 });
                    }
                })
                return false;
            });

            // 自定义验证
            // form.verify({
            //     regDteVerify: function (value) {
            //         //获取失效日期
            //         var endDate = $("#end_date").val();
            //         if (endDate < value) {
            //             return '注册日期不得大于失效日期';
            //         }
            //     }
            // });
        })
    </script>
</body>

</html>